═══════════════════════════════════════════════════════════════
  MANUAL WORKER UPDATE - Restore Working Version
═══════════════════════════════════════════════════════════════

The worker-d1.js file has been restored to the original working version.
Follow these steps to update it manually in Cloudflare Dashboard:

═══════════════════════════════════════════════════════════════
  STEP 1: Open Cloudflare Dashboard
═══════════════════════════════════════════════════════════════

1. Go to: https://dash.cloudflare.com
2. Log in to your account
3. Select your account/zone (audiocity-ug.com)

═══════════════════════════════════════════════════════════════
  STEP 2: Find Your Worker
═══════════════════════════════════════════════════════════════

1. Click "Workers & Pages" in the left sidebar
2. Find "audio-city-api-d1" in the list
3. Click on it to open

═══════════════════════════════════════════════════════════════
  STEP 3: Update the Worker Code
═══════════════════════════════════════════════════════════════

1. Click "Edit code" or "Quick edit" button
2. This opens the code editor
3. Select ALL the code (Ctrl+A or Cmd+A)
4. Delete it
5. Open the file: worker-d1.js (from your local project)
6. Copy ALL the contents (Ctrl+A, Ctrl+C)
7. Paste into the Cloudflare editor (Ctrl+V)
8. Click "Save and deploy" button
9. Wait for deployment to complete (usually 10-30 seconds)

═══════════════════════════════════════════════════════════════
  STEP 4: Verify Configuration
═══════════════════════════════════════════════════════════════

1. Go to "Settings" tab
2. Check "Triggers" → "Custom Domains"
3. Verify: api.audiocity-ug.com is listed
4. Make sure www.audiocity-ug.com is NOT listed
   (If it is, remove it - static files should go to Pages)

5. Check "Resources" → "D1 Database"
   - Should show: audio-city-db
   - Binding: DB

6. Check "Resources" → "R2 Bucket"
   - Should show: audio-city-tracks
   - Binding: MEDIA_BUCKET

═══════════════════════════════════════════════════════════════
  STEP 5: Test
═══════════════════════════════════════════════════════════════

1. Test API endpoint:
   Open: https://api.audiocity-ug.com/api/health
   Should return: {"status":"ok",...}

2. Test static files:
   Open: https://www.audiocity-ug.com/discover.html
   Should load the page (not 503 error)

═══════════════════════════════════════════════════════════════
  IMPORTANT NOTES
═══════════════════════════════════════════════════════════════

✅ The worker-d1.js file is now back to the original working version
✅ No blocking code - it only handles /api/* and /auth/* routes
✅ Returns 404 for non-API routes (normal behavior)
✅ Static files should be served by Cloudflare Pages, not Worker

═══════════════════════════════════════════════════════════════
  TROUBLESHOOTING
═══════════════════════════════════════════════════════════════

If site still doesn't work after update:

1. Check Worker logs:
   - Workers & Pages → audio-city-api-d1 → Logs
   - Look for errors

2. Check if Worker is bound to wrong domain:
   - Settings → Triggers → Custom Domains
   - Remove www.audiocity-ug.com if present

3. Clear Cloudflare cache:
   - Caching → Purge Everything
   - Wait 30 seconds

4. Verify Pages deployment:
   - Pages → Your project
   - Check if www.audiocity-ug.com is bound to Pages

═══════════════════════════════════════════════════════════════






